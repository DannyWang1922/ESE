For 4090 Training
NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0

Training
python train.py --epochs 10 --batch_size 32 --is_llm 0 --pooling_strategy cls --model_name_or_path BAAI/bge-base-en-v1.5 --apply_ese 0 --save_dir train_res/bge
python train.py --epochs 10 --batch_size 32 --is_llm 0 --pooling_strategy cls --model_name_or_path BAAI/bge-base-en-v1.5 --apply_ese 1 --save_dir train_res/bge_ese

Training using yaml
CUDA_VISIBLE_DEVICES=0 python train_self.py --config config/bert_base.yaml
CUDA_VISIBLE_DEVICES=0 python train_self.py --config config/bert_ese.yaml

eval
python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --model_name_or_path models/bert_base --out_dir evl_res/bert_base
python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --model_name_or_path models/bert_base_ese --out_dir evl_res/bert_base
python eval_ese_layers.py --is_llm 0 --pooling_strategy cls  --model_name_or_path_list models/bert_base_ese,models/bert_base,google-bert/bert-base-uncased --out_dir evl_res/bert_base/plot


eval OLMoE 4090 bs 256
CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 1 --pooling_strategy last  --batch_size 256 --model_name_or_path allenai/OLMoE-1B-7B-0924 --out_dir evl_res/OLMoE_last
CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 1 --pooling_strategy mean  --batch_size 256 --model_name_or_path allenai/OLMoE-1B-7B-0924 --out_dir evl_res/OLMoE_mean

NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python train_moe.py --config config/bert_moe_base_11.yaml
NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python train_moe.py --config config/bert_moe_ese_11.yaml

CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 256 --model_name_or_path train_res/bert_ese_base/best-checkpoint --out_dir evl_res/bert_ese_base
CUDA_VISIBLE_DEVICES=0 python eval_ese_layers.py --is_llm 0 --pooling_strategy cls  --batch_size 256 --model_name_or_path_list train_res/bert_ese_base/best-checkpoint --out_dir evl_res/bert_ese_base/plot

NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path BAAI/bge-base-en-v1.5 --out_dir evl_res/bge --is_moe 0

NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path train_result/bge_base/best-checkpoint --out_dir evl_res/bge_base --is_moe 0
NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path train_result/bge_ese/best-checkpoint --out_dir evl_res/bge_ese --is_moe 0
NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path train_result/bge_moe_base_all/best-checkpoint --out_dir evl_res/bge_moe_base_all --is_moe 1
NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=1 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path train_result/bge_moe_ese_all/best-checkpoint --out_dir evl_res/bge_moe_ese_all --is_moe 1
NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=1 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path train_result/bge_moe_ese_all_50W/best-checkpoint --out_dir evl_res/bge_moe_ese_all_50W --is_moe 1

NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 256 --model_name_or_path train_result/bge_moe_ese_all_all_data/best-checkpoint --out_dir evl_res/bge_moe_ese_all_all_data --is_moe 1

NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=0 python eval_ese_layers.py --is_llm 0 --pooling_strategy cls  --batch_size 256 --model_name_or_path_list train_result/bge_moe_ese_all_50W/best-checkpoint --out_dir evl_res/bge_moe_ese_all_50W/plot

NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=1 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path output/bge_moe_ese_all_100000/best-checkpoint --out_dir evl_res/bge_moe_ese_all_10w --is_moe 1
NCCL_P2P_DISABLE=1 NCCL_IB_DISABLE=1 CUDA_VISIBLE_DEVICES=1 python eval_nli_main.py --is_llm 0 --pooling_strategy cls  --batch_size 512 --model_name_or_path output/bge_moe_ese_all_300000/best-checkpoint --out_dir evl_res/bge_moe_ese_all_30w --is_moe 1